Sub ExportGALToCSV()
    Dim OutlookApp As Object
    Dim Namespace As Object
    Dim GAL As Object
    Dim AddressEntry As Object
    Dim csvFile As Object
    Dim filePath As String
    Dim line As String
    
    ' Set file path
    filePath = "C:\Users\Public\GAL_Contacts.csv"
    
    ' Create file
    Set csvFile = CreateObject("Scripting.FileSystemObject").CreateTextFile(filePath, True)
    
    ' Write header
    csvFile.WriteLine "Name,Email,Job Title,Department,Company"
    
    ' Initialize Outlook objects
    Set OutlookApp = CreateObject("Outlook.Application")
    Set Namespace = OutlookApp.GetNamespace("MAPI")
    Set GAL = Namespace.AddressLists("Global Address List")
    
    ' Loop through each entry
    For Each AddressEntry In GAL.AddressEntries
        If AddressEntry.AddressEntryUserType = 0 Then ' Ensure it's a user
            line = AddressEntry.Name & "," & AddressEntry.Address & ","
            line = line & AddressEntry.GetExchangeUser().JobTitle & ","
            line = line & AddressEntry.GetExchangeUser().Department & ","
            line = line & AddressEntry.GetExchangeUser().CompanyName
            csvFile.WriteLine line
        End If
    Next AddressEntry
    
    csvFile.Close
    MsgBox "Export completed. File saved at: " & filePath, vbInformation, "Success"
End Sub

pip install exchangelib pandas

from exchangelib import Credentials, Account
import pandas as pd

# Set credentials
credentials = Credentials("your.email@company.com", "your_password")

# Connect to Exchange
account = Account("your.email@company.com", credentials=credentials, autodiscover=True)

# Fetch GAL
contacts = []
for contact in account.contacts.all():
    contacts.append([contact.display_name, contact.email_addresses, contact.job_title])

# Convert to DataFrame
df = pd.DataFrame(contacts, columns=["Full Name", "Email", "Job Title"])
df.to_csv("C:\\Users\\Public\\GAL_EWS.csv", index=False)

print("Export Completed!")

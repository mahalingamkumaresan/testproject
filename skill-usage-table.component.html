<p-skeleton *ngIf="isLoading" height="500px" width="100%"></p-skeleton>

<div *ngIf="!isLoading">
  <highcharts-chart
    [Highcharts]="Highcharts"
    [options]="chartOptionsRadar"
    style="width: 100%; height: 500px; display: block;">
  </highcharts-chart>
</div>

<p-skeleton *ngIf="isLoading" height="400px" width="100%"></p-skeleton>

<p-table
  *ngIf="!isLoading && processedData?.length"
  [value]="processedData"
  [paginator]="true"
  [rows]="10"
  responsiveLayout="scroll">
  <ng-template pTemplate="header">
    <tr>
      <th>Trainee</th>
      <th *ngFor="let tech of allTechnologies">
        <div class="tech-header">{{ tech.toUpperCase() }}</div>
        <div class="tech-subheader">Before | During | After</div>
      </th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-row>
    <tr>
      <td>{{ row.trainee }}</td>
      <td *ngFor="let tech of allTechnologies" class="skill-cell">
        <span
          class="phase"
          [pTooltip]="getTooltip(row, tech, 'before')">
          {{ row[tech + '_before'] || 0 }}%
        </span>
        <span
          class="phase"
          [ngClass]="{ 'uptick': hasUptick(row, tech, 'during') }"
          [pTooltip]="getTooltip(row, tech, 'during')">
          {{ row[tech + '_during'] || 0 }}%
        </span>
        <span
          class="phase"
          [ngClass]="{ 'uptick': hasUptick(row, tech, 'after') }"
          [pTooltip]="getTooltip(row, tech, 'after')">
          {{ row[tech + '_after'] || 0 }}%
        </span>
      </td>
    </tr>
  </ng-template>
</p-table>

<div class="legend">
  <h4>Legend</h4>
  <ul>
    <li><strong>Before:</strong> Jan–Mar 2024</li>
    <li><strong>During:</strong> Apr–Jul 2024</li>
    <li><strong>After:</strong> Aug–Nov 2024 (or till Mar 2025 if flag is true)</li>
    <li><strong style="color: green;">Green Highlight:</strong> Contribution increase from Before phase</li>
    <li><strong>% Value:</strong> (Tech commits / Total commits) × 100 for each trainee</li>
  </ul>
</div>
